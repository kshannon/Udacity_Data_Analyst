---
title: "baseball_explore"
author: "Kyle Shannon"
date: "July 26, 2016"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Load Libraries, echo=FALSE, message=FALSE, include=FALSE}
library(ggplot2) #must load the ggplot package first
library(ggthemes)
library(dplyr)
library(gridExtra)
library(RColorBrewer)
library(reshape2)
```

```{r Load baseball data, echo=FALSE}
# Load the Data
data <- read.csv('baseball_data.csv', header = T)
# Dropping X column - It's just an identifier
#wine_data <- subset(wine_data, select = - X)
```

## Basic Summary Exploration
```{r baseball summary, echo=FALSE}
#summarize wine_data
summary(data)
str(data)
```

## Num Data
```{r num data, echo=FALSE}
num_data <- data
num_data <- subset( num_data, select = - name)

levels(num_data$handedness)

# B = 1, L = 2, R = 3
num_data <- within(num_data, handedness <- factor(handedness, labels = c(0, 1, 2)))

num_data$handedness <- as.integer(num_data$handedness)
sapply(num_data, is.numeric)
```



```{r height distro/ summary, echo=FALSE}
ggplot(aes(x = height), data = data) +
  geom_histogram(binwidth = 1, colour="black") +
  labs(title = "Height Distribution", x = "height (in)") +
  theme_bw()

summary(data$height)

```


```{r weight distro/ summary, echo=FALSE}
ggplot(aes(x = weight), data = data) +
  geom_histogram(binwidth = 1, colour="black") +
  labs(title = "weight Distribution", x = "weight (lbs)") +
  theme_bw()

summary(data$weight)

```

```{r avg distro/ summary, echo=FALSE}
ggplot(aes(x = avg), data = data) +
  geom_histogram(binwidth = .005, colour="black") +
  labs(title = "avg Distribution", x = "avg") +
  theme_bw()

summary(data$avg)

```

```{r hr distro/ summary, echo=FALSE}
ggplot(aes(x = HR), data = data) +
  geom_histogram(binwidth = 3, colour="black") +
  labs(title = "hr Distribution", x = "hr") +
  theme_bw()

summary(data$HR)
```

```{r corr heat map, echo=FALSE, results='hide'}

cormat <- round(cor(data),2)
head(cormat)
tail(cormat)


melted_cormat <- melt(cormat)
head(melted_cormat)
tail(melted_cormat)


# Get lower triangle of the correlation matrix
  get_lower_tri<-function(cormat){
    cormat[upper.tri(cormat)] <- NA
    return(cormat)
  }
  # Get upper triangle of the correlation matrix
  get_upper_tri <- function(cormat){
    cormat[lower.tri(cormat)]<- NA
    return(cormat)
  }
  
upper_tri <- get_upper_tri(cormat)
upper_tri

melted_cormat <- melt(upper_tri, na.rm = TRUE)



ggplot(data = melted_cormat, aes(x=Var1, y=Var2, fill=value)) +
  labs(x="Features", y="Features", title="Correlation Heatmap Matrix") +
  geom_tile(data=melted_cormat, aes(fill=value), color="black")+
  geom_text(aes(Var2, Var1, label = value), color = "black", size = 2)+
  scale_fill_gradient2(low="#3794bf", high="#df8640", mid="#ffffff", midpoint=0, limit=c(-1,1),name="Correlation\n(Pearson)") +
  theme(axis.text.x = element_text(angle=45, vjust=1, size=11, hjust=1), legend.title = element_text(size=10))+
  coord_equal()

```


```{r citric acids with quiality, echo=FALSE}

#df[df$prop == 0] <- NA
#num_data[which(num_data$avg>0),],


p1 <- ggplot(aes(x = avg, y = height), data = num_data) +
  geom_point(alpha = 1/4, position = 'jitter') + 
  geom_smooth(method = "lm", se = TRUE) +
  scale_x_continuous(limits = c(0, 1)

p2 <- ggplot(aes(x = avg, y = HR), data = num_data) +
  geom_point(alpha = 1/4, position = 'jitter')+ 
  geom_smooth(method = "lm", se = TRUE)

grid.arrange(p1, p2, nrow = 1)

```





